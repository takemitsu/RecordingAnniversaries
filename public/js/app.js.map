{"version":3,"sources":["app.coffee"],"names":[],"mappings":"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","file":"app.js","sourcesContent":["\nmainApp = angular.module 'mainApp', [\n  'ngRoute'\n#  'ngSanitize'\n#  'mainFactories'\n  'mainControllers'\n  'ui.bootstrap'\n#  'angularFileUpload'\n#  'hc.marked'\n#  'ui.utils'\n]\n\nmainApp.config ['$routeProvider', ($routeProvider) ->\n    $routeProvider\n    .when '/index',\n      templateUrl: '/partials/anniv/index.html'\n      controller: 'AnnivIndexController'\n    .when '/list',\n      templateUrl: '/partials/anniv/list.html'\n      controller: 'AnnivListController'\n    # entity\n    .when '/entity',\n      templateUrl: '/partials/entity/edit.html'\n      controller: 'EntityEditController'\n    .when '/entity/:id',\n      templateUrl: '/partials/entity/edit.html'\n      controller: 'EntityEditController'\n    # days\n    .when '/entity/:entity_id/days',\n      templateUrl: '/partials/days/edit.html'\n      controller: 'DaysEditController'\n    .when '/entity/:entity_id/days/:id',\n      templateUrl: '/partials/days/edit.html'\n      controller: 'DaysEditController'\n\n    .otherwise\n      redirectTo: '/index'\n]\n\n\nmainControllers = angular.module 'mainControllers', []\n\n\nmainControllers.filter 'JDate', ->\n  return (input, only_wayear) ->\n\n    if not input\n        return ''\n\n    if input.length isnt 10\n        return ''\n\n    dates = input.split(\"-\");\n    if dates.length isnt 3\n        return ''\n\n    date = parseInt(dates.join(\"\"))\n    if not date\n        return ''\n\n    if dates[0] > 2099\n        return ''\n    if dates[1] > 12 || dates[1] is \"00\"\n        return ''\n    if dates[2] > 31 || dates[2] is \"00\"\n        return\n\n    if date >= 20190501\n        gengo = '令和'\n        wayear = dates[0] - 2018\n    else if date >= 19890108\n        gengo = '平成'\n        wayear = dates[0] - 1988\n    else if date >= 19261225\n        gengo = '昭和'\n        wayear = dates[0] - 1925\n    else if date >= 19120730\n        gengo = '大正'\n        wayear = dates[0] - 1911\n    else if date >= 18680125\n        gengo = '明治'\n        wayear = dates[0] - 1867\n    else\n        return ''\n\n    if wayear is 1\n        wayear = '元'\n\n    if only_wayear is 1\n        return gengo + wayear + '年'\n\n    return gengo + wayear + '年' + dates[1] + '月' + dates[2] + '日'\n\n\nmainControllers.filter 'DiffDate', ->\n  return (input) ->\n\n    # 前置き\n\n    if not input\n        return ''\n\n    if input.length isnt 10\n        return ''\n\n    dates = input.split(\"-\");\n    if dates.length isnt 3\n        return ''\n\n    date = parseInt(dates.join(\"\"))\n    if not date\n        return ''\n\n    if dates[0] > 2099\n        return ''\n    if dates[1] > 12 || dates[1] is \"00\"\n        return ''\n    if dates[2] > 31 || dates[2] is \"00\"\n        return\n\n    # 本処理\n\n    date = new Date(dates[0], dates[1] - 1, dates[2])\n    now = new Date()\n    now = new Date(now.getFullYear(), now.getMonth(), now.getDate())\n\n    diff_date = new Date(now.getFullYear(), date.getMonth(), date.getDate())\n    if now > diff_date\n        diff_date = new Date(now.getFullYear() + 1, date.getMonth(), date.getDate())\n\n    diff = diff_date - now;\n    diffDay = diff / 86400000\n    return diffDay\n\n\nmainControllers.filter 'Nenrei', ->\n  return (input, append_year, unit, month_flag, unit_month) ->\n\n    if not input\n        return ''\n\n    if input.length isnt 10\n        return ''\n\n    dates = input.split(\"-\");\n    if dates.length isnt 3\n        return ''\n\n    date = parseInt(dates.join(\"\"))\n    if not date\n        return ''\n\n    if dates[0] > 2099\n        return ''\n    if dates[1] > 12 || dates[1] is \"00\"\n        return ''\n    if dates[2] > 31 || dates[2] is \"00\"\n        return\n\n    # ----------------------------------\n    # console.log append_year\n    # now = new Date()\n    # now = new Date(now.getFullYear(), now.getMonth(), now.getDate())\n    # if append_year\n    #     return now.getFullYear() - dates[0] + append_year\n    # return now.getFullYear() - dates[0]\n    # diff_date = new Date(dates[0], dates[1] - 1, dates[2])\n    # diff_date = new Date(now.getFullYear(), date.getMonth(), date.getDate())\n    # if now > diff_date\n    #     diff_date = new Date(now.getFullYear() + 1, date.getMonth(), date.getDate())\n\n    today = new Date();\n    today = today.getFullYear() * 10000 + today.getMonth() * 100 + 100 + today.getDate()\n    birthday = parseInt(dates.join(\"\"));\n    # console.log birthday\n    # birthday = parseInt(input.replace(/-/g,’’));\n    diff = Math.floor((today - birthday) / 10000);\n\n    if append_year\n        diff += 1\n    if diff < 0\n        return ''\n    if unit\n        diff += \" \" + unit\n    # console.log month_flag\n    # if month_flag\n    #     today = new Date()\n    #     today_m = today.getMonth() + 1\n    #     today_d = today.getDate()\n    #     if today_m < dates[1]\n    #         today_m += 12\n    #     if today_m == dates[1] && today_d < date[2]\n    #         today_m += 12\n    #     if today_d >= dates[2]\n    #         today_m += 1\n    #     age_m = today_m - dates[1]\n    #     diff += \" \" + age_m\n\n    #     if unit_month\n    #         diff += \" \" + unit_month\n\n    return diff\n\n\nshowMessage = (type, message, autoclose=true) ->\n    $('#message .alert').addClass('alert-'+type).empty().append(message)\n    $('#message').removeClass('hidden').show 'fade'\n    if autoclose\n        setTimeout ->\n            $('#message').hide 'fade', ->\n                $('#message .alert').removeClass('alert-'+type)\n        , 2000\nshowSuccessMessage = (message) ->\n    showMessage 'success', message\nshowErrorMessage = (message) ->\n    showMessage 'danger', message\n\nnetworkError = (json, status) ->\n  if status != 401\n    showErrorMessage json.message\n  else\n    location.href = '/'\n\n\nmainControllers.controller 'AnnivIndexController', ($scope, $http, $location, $routeParams, $modal, $log) ->\n\n\t$scope.loadDetail = ->\n\t\t$http.get \"/api/entities/pickup\"\n\t\t.success (data) ->\n\t\t\t$scope.entities = data\n\t\t\tif data.length is 0\n\t\t\t\tlocation.href = \"#/list\"\n\t\t.error (data) ->\n\t\t\t$log.info(data)\n\n\t$scope.loadDetail()\n\n\nmainControllers.controller 'AnnivListController', ($scope, $http, $location, $route, $routeParams, $modal, $log) ->\n\n\t$scope.maxSize = 5\n\t$scope.itemPerPage = 10\n\t$scope.totalItems = 1\n\t$scope.filters = {\n\t\tpage: 1\n\t}\n\n\t$scope.loadDetail = ->\n\t\t$http.get \"/api/entities\",\n\t\t\tparams: $scope.filters\n\t\t.success (data) ->\n\t\t\t$scope.entities = data.data\n\t\t\t$scope.filters.page = data.current_page\n\t\t\t$scope.itemPerPage = data.per_page\n\t\t\t$scope.totalItems = data.total\n\t\t.error (data) ->\n\t\t\t$log.info(data)\n\n\t$scope.loadDetail()\n\n\t$scope.addEntity = ->\n\t\t$location.path \"/entity\"\n\n\t$scope.editEntity = (entity) ->\n\t\t$location.path '/entity/' + entity.id\n\n\t$scope.deleteEntity = (entity) ->\n\t\tif confirm(entity.name + \" を削除します。よろしいですか？\")\n\t\t\t$http\n\t\t\t\tmethod: 'delete'\n\t\t\t\turl: \"/api/entities/\" + entity.id\n\t\t\t.success (json) ->\n\t\t\t\t$scope.loadDetail()\n\t\t\t.error networkError\n\n\t$scope.addAnniv = (entity) ->\n\t\t$location.path \"/entity/\" + entity.id + \"/days\"\n\n\t$scope.editAnniv = (entity, anniv) ->\n\t\t$location.path \"/entity/\" + entity.id + \"/days/\" + anniv.id\n\n\t$scope.deleteAnniv = (anniv) ->\n\t\tif confirm(anniv.name + \" を削除します。よろしいですか？\")\n\t\t\t$http\n\t\t\t\tmethod: 'delete'\n\t\t\t\turl: '/api/entities/' + anniv.entity_id + '/days/' + anniv.id\n\t\t\t.success (json) ->\n\t\t\t\t$scope.loadDetail()\n\t\t\t.error networkError\n\n\nmainControllers.controller 'EntityEditController', ($scope, $http, $location, $route, $routeParams, $log) ->\n    $log.info $routeParams.id\n\n    $scope.entity = {}\n    $scope.old_entity = {}\n\n    if $routeParams.id\n        $http.get \"/api/entities/\" + $routeParams.id\n        .success (json) ->\n            $scope.old_entity = json\n            $scope.entity = json\n        .error networkError\n\n    $scope.save = ->\n        method = 'post'\n        endPoint = \"/api/entities\"\n        if $scope.old_entity.id\n            method = 'put'\n            endPoint += \"/\" + $scope.old_entity.id\n\n        $http\n            method: method\n            url: endPoint\n            data: $scope.entity\n        .success (json) ->\n            showSuccessMessage '保存しました'\n            $scope.redirect()\n        .error networkError\n\n    $scope.cancel = ->\n        $scope.redirect()\n\n    $scope.redirect = ->\n        $location.path \"/list\"\n\n\nmainControllers.controller 'DaysEditController', ($scope, $http, $location, $route, $routeParams, $filter, $log) ->\n    $log.info $routeParams\n\n    $scope.days = {}\n    $scope.old_days = {}\n\n    if $routeParams.id && $routeParams.entity_id\n        $http.get \"/api/entities/\" + $routeParams.entity_id + \"/days/\" + $routeParams.id\n        .success (json) ->\n            $scope.old_days = json\n            $scope.days = json\n        .error networkError\n\n    $scope.today = ->\n        $scope.days.anniv_at = new Date()\n    $scope.clear = ->\n        $scope.days.anniv_at = null\n\n    $scope.open = ($event) ->\n        $event.preventDefault()\n        $event.stopPropagation()\n        $scope.opened = true\n\n    $scope.dateOptions =\n        formatYear: 'yy'\n        startingDay: 1\n\n    $scope.format = 'yyyy-MM-dd'\n\n    $scope.save = ->\n        $scope.days.anniv_at = $filter('date')($scope.days.anniv_at, $scope.format)\n\n        method = 'post'\n        endPoint = \"/api/entities/\" + $routeParams.entity_id + \"/days\"\n\n        if $routeParams.id\n            method = 'put'\n            endPoint += \"/\" + $routeParams.id\n\n        $http\n            method: method\n            url: endPoint\n            data: $scope.days\n        .success (json) ->\n            showSuccessMessage '保存しました'\n            $scope.redirect()\n        .error networkError\n\n    $scope.cancel = ->\n        $scope.redirect()\n\n    $scope.redirect = ->\n        $location.path \"/list\"\n"]}